<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Abhijith M S">
<meta name="dcterms.date" content="2025-02-28">

<title>4&nbsp; Analysis of Variance (ANOVA) – Statistical Modeling - 24DS636 (2024-25)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Regression.html" rel="next">
<link href="./HypothesisTesting.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Anova.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Modeling - 24DS636 (2024-25)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DescriptiveStatistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ParameterEstimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HypothesisTesting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#one-way-analysis-of-variance" id="toc-one-way-analysis-of-variance" class="nav-link" data-scroll-target="#one-way-analysis-of-variance"><span class="header-section-number">4.2</span> One-way Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#how-to-do-the-hypothesis-testing" id="toc-how-to-do-the-hypothesis-testing" class="nav-link" data-scroll-target="#how-to-do-the-hypothesis-testing">How to do the hypothesis testing</a></li>
  <li><a href="#summary-of-one-way-analysis-of-variance" id="toc-summary-of-one-way-analysis-of-variance" class="nav-link" data-scroll-target="#summary-of-one-way-analysis-of-variance">Summary of one-way analysis of variance</a></li>
  <li><a href="#multiple-comparisons-of-sample-means" id="toc-multiple-comparisons-of-sample-means" class="nav-link" data-scroll-target="#multiple-comparisons-of-sample-means">Multiple Comparisons of Sample Means</a></li>
  <li><a href="#one-way-analysis-of-variance-with-unequal-sample-sizes" id="toc-one-way-analysis-of-variance-with-unequal-sample-sizes" class="nav-link" data-scroll-target="#one-way-analysis-of-variance-with-unequal-sample-sizes"><span class="header-section-number">4.2.1</span> One-Way Analysis of Variance with Unequal Sample Sizes</a></li>
  </ul></li>
  <li><a href="#two-way-analysis-of-variance" id="toc-two-way-analysis-of-variance" class="nav-link" data-scroll-target="#two-way-analysis-of-variance"><span class="header-section-number">4.3</span> Two-way Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#introduction-1" id="toc-introduction-1" class="nav-link" data-scroll-target="#introduction-1">Introduction</a></li>
  <li><a href="#summary-of-two-way-analysis-of-variance" id="toc-summary-of-two-way-analysis-of-variance" class="nav-link" data-scroll-target="#summary-of-two-way-analysis-of-variance">Summary of Two-way analysis of variance</a></li>
  <li><a href="#supplementary-topics" id="toc-supplementary-topics" class="nav-link" data-scroll-target="#supplementary-topics">Supplementary Topics</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Abhijith M S </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 28, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1</span> Introduction</h2>
<p>Here, we will perform an Analysis of Variance (ANOVA) to determine if there are any statistically significant differences between the means of three or more independent groups.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comparison of means of three samples
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Consider three <strong>independent samples</strong>:</p>
<ul>
<li><strong>X</strong>: 10, 20, 30, 40</li>
<li><strong>Y</strong>: 12, 21, 34, 39</li>
<li><strong>Z</strong>: 8, 11, 31, 39</li>
</ul></li>
<li><p>We want to test if the means of these three samples are <strong>significantly different</strong> from each other.</p></li>
<li><p><strong>Calculate the mean of each sample</strong>:</p>
<ul>
<li>Mean of <strong>X</strong>: <span class="math inline">\((10 + 20 + 30 + 40) / 4 = 25\)</span></li>
<li>Mean of <strong>Y</strong>: <span class="math inline">\((12 + 21 + 34 + 39) / 4 = 26.5\)</span></li>
<li>Mean of <strong>Z</strong>: <span class="math inline">\((8 + 11 + 31 + 39) / 4 = 22.25\)</span></li>
</ul></li>
<li><p><strong>Calculate the overall mean (grand mean)</strong> of all the samples combined:</p>
<ul>
<li>Grand Mean: <span class="math inline">\((10 + 20 + 30 + 40 + 12 + 21 + 34 + 39 + 8 + 11 + 31 + 39) / 12 = 24.58\)</span></li>
</ul></li>
</ul>
</div>
</div>
<div id="0a398c63" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array([<span class="dv">12</span>, <span class="dv">21</span>, <span class="dv">34</span>, <span class="dv">39</span>])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array([<span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">31</span>, <span class="dv">39</span>])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Grand mean</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="op">=</span> np.mean(np.concatenate([X, Y, Z]))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.ones_like(X), X, label<span class="op">=</span><span class="st">'X'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.ones_like(Y) <span class="op">*</span> <span class="dv">2</span>, Y, label<span class="op">=</span><span class="st">'Y'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.ones_like(Z) <span class="op">*</span> <span class="dv">3</span>, Z, label<span class="op">=</span><span class="st">'Z'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>])</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Samples'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Values'</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot of Samples'</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>plt.axhline(grand_mean, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Grand Mean'</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>plt.boxplot([X, Y, Z], labels<span class="op">=</span>[<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>])</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Samples'</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Values'</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Box Plot of Samples'</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>plt.axhline(grand_mean, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Grand Mean'</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Anova_files/figure-html/cell-2-output-1.png" width="1141" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ff1375a0" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>])</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array([<span class="dv">12</span>, <span class="dv">21</span>, <span class="dv">34</span>, <span class="dv">39</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array([<span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">31</span>, <span class="dv">39</span>])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Means</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>mean_X <span class="op">=</span> np.mean(X)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>mean_Y <span class="op">=</span> np.mean(Y)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>mean_Z <span class="op">=</span> np.mean(Z)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Grand mean</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="op">=</span> np.mean(np.concatenate([X, Y, Z]))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.ones_like(X), X, label<span class="op">=</span><span class="st">'X'</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.ones_like(Y) <span class="op">*</span> <span class="dv">2</span>, Y, label<span class="op">=</span><span class="st">'Y'</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.ones_like(Z) <span class="op">*</span> <span class="dv">3</span>, Z, label<span class="op">=</span><span class="st">'Z'</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">1</span>], [mean_X], label<span class="op">=</span><span class="st">'Mean of X'</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">2</span>], [mean_Y], label<span class="op">=</span><span class="st">'Mean of Y'</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">3</span>], [mean_Z], label<span class="op">=</span><span class="st">'Mean of Z'</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>])</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Samples'</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Means'</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot of Sample Means'</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.axhline(grand_mean, color='red', linestyle='--', label='Grand Mean')</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.legend(outside)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'center right'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.25</span>, <span class="fl">0.5</span>))</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>plt.boxplot([X, Y, Z], labels<span class="op">=</span>[<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>])</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>plt.boxplot([[mean_X], [mean_Y], [mean_Z]], labels<span class="op">=</span>[<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>])</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Samples'</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Means'</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Box Plot of Sample Means'</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.axhline(grand_mean, color='red', linestyle='--', label='Grand Mean')</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Anova_files/figure-html/cell-3-output-2.png" width="1133" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="one-way-analysis-of-variance" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="one-way-analysis-of-variance"><span class="header-section-number">4.2</span> One-way Analysis of Variance</h2>
<ul>
<li>Consider <strong>m independent samples</strong>, each of size <strong>n</strong>.
<ul>
<li><p>The members of the <strong>ith sample</strong> are denoted as:<br>
<span class="math inline">\(X_{i1}, X_{i2}, \dots, X_{in}\)</span>.</p></li>
<li><p>Each <span class="math inline">\(X_{ij}\)</span> is a <strong>normal random variable</strong> with:</p>
<ul>
<li>Unknown mean: <span class="math inline">\(\mu_i\)</span>.</li>
<li>Unknown variance: <span class="math inline">\(\sigma^2\)</span>.</li>
</ul></li>
<li><p>Mathematically:<br>
<span class="math inline">\(X_{ij} \sim N(\mu_i, \sigma^2)\)</span>, where:</p>
<ul>
<li><span class="math inline">\(i = 1, \dots, m\)</span>.</li>
<li><span class="math inline">\(j = 1, \dots, n\)</span>.</li>
</ul></li>
</ul></li>
<li><strong>Hypothesis Testing</strong>:
<ul>
<li><p><strong>Null Hypothesis</strong> (<span class="math inline">\(H_0\)</span>):<br>
<span class="math inline">\(\mu_1 = \mu_2 = \dots = \mu_m\)</span>.<br>
(All population means are equal.)</p></li>
<li><p><strong>Alternative Hypothesis</strong> (<span class="math inline">\(H_1\)</span>):<br>
Not all means are equal.<br>
(At least two means differ.)</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Interpretation</strong>:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Imagine <strong>m different treatments</strong>.</li>
<li>Applying <strong>treatment i</strong> to an item results in a normal random variable with:
<ul>
<li>Mean: <span class="math inline">\(\mu_i\)</span>.</li>
<li>Variance: <span class="math inline">\(\sigma^2\)</span>.</li>
</ul></li>
<li>Goal: Test if <strong>all treatments have the same effect</strong>.</li>
<li>Method:
<ul>
<li>Apply each treatment to a <strong>different sample of n items</strong>.</li>
<li>Analyze the results to compare the means.</li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li><p>Since there are a total of <strong>nm independent normal random variables</strong> <span class="math inline">\(X_{ij}\)</span>:</p>
<ul>
<li>The sum of the squares of their standardized versions follows a <strong>chi-square distribution</strong> with <strong>nm degrees of freedom</strong>.</li>
<li>Mathematically:<br>
<span id="eq-anova1"><span class="math display">\[
\sum_{i=1}^{m} \sum_{j=1}^{n} \frac{(X_{ij} - E[X_{ij}])^2}{\sigma^2} = \sum_{i=1}^{m} \sum_{j=1}^{n} \frac{(X_{ij} - \mu_i)^2}{\sigma^2} \sim \chi^2_{nm}
\tag{4.1}\]</span></span></li>
</ul></li>
<li><p>To estimate the <strong>m unknown parameters</strong> <span class="math inline">\(\mu_1, \dots, \mu_m\)</span>:</p>
<ul>
<li>Let <span class="math inline">\(X_{i}\)</span> denote the <strong>sample mean</strong> of the <strong>ith sample</strong>: <span class="math display">\[
\bar{X}_{i} = \sum_{j=1}^{n} \frac{X_{ij}}{n}
\]</span></li>
<li>Here, <span class="math inline">\(\bar{X}_{i}\)</span> is the <strong>estimator</strong> of the population mean <span class="math inline">\(\mu_i\)</span> for <span class="math inline">\(i = 1, \dots, m\)</span>.</li>
</ul></li>
<li><p>Substituting the estimators <span class="math inline">\(\bar{X}_{i}\)</span> for <span class="math inline">\(\mu_i\)</span> in Equation <a href="#eq-anova1" class="quarto-xref">Equation&nbsp;<span>4.1</span></a>:</p>
<ul>
<li>The resulting variable: <span id="eq-anova2"><span class="math display">\[
\sum_{i=1}^{m} \sum_{j=1}^{n} \frac{(X_{ij} - \bar{X}_{i})^2}{\sigma^2}
\tag{4.2}\]</span></span> follows a <strong>chi-square distribution</strong> with <strong>nm − m degrees of freedom</strong>.<br>
(One degree of freedom is lost for each estimated parameter.)</li>
</ul></li>
<li><p>Define: <span class="math display">\[
SSW = \sum_{i=1}^{m} \sum_{j=1}^{n} (X_{ij} - \bar{X}_{i})^2
\]</span></p>
<ul>
<li>The variable in <a href="#eq-anova2" class="quarto-xref">Equation&nbsp;<span>4.2</span></a> becomes <span class="math inline">\(\frac{SSW}{\sigma^2}\)</span>.</li>
</ul></li>
<li><p>Since the <strong>expected value</strong> of a chi-square random variable equals its degrees of freedom:</p>
<ul>
<li>Taking the expectation of the variable in Equation <a href="#eq-anova2" class="quarto-xref">Equation&nbsp;<span>4.2</span></a> gives: <span class="math display">\[
E\left[\frac{SSW}{\sigma^2}\right] = nm - m
\]</span></li>
<li>Equivalently: <span class="math display">\[
E\left[\frac{SSW}{nm - m}\right] = \sigma^2
\]</span></li>
</ul></li>
<li><p>We thus have our first estimator of <span class="math inline">\(\sigma^2\)</span>, namely, SSW /(nm - m). The statistic SSW is called the <strong>Sum of Squares Within Samples</strong> aka ( within samples sum of squares or sum of squares within groups).</p></li>
<li><p><strong>Also, note that this estimator was obtained without assuming anything about the truth or falsity of the null hypothesis.</strong></p></li>
<li><p>Our <strong>second estimator</strong> of <span class="math inline">\(\sigma^2\)</span> is valid <strong>only when the null hypothesis is true</strong>.</p>
<ul>
<li>Assume <span class="math inline">\(H_0\)</span> is true, meaning all population means <span class="math inline">\(\mu_i\)</span> are equal, i.e., <span class="math inline">\(\mu_i = \mu\)</span> for all <span class="math inline">\(i\)</span>.</li>
<li>Under this assumption:
<ul>
<li>The sample means <span class="math inline">\(\bar{X}_1, \bar{X}_2, \dots, \bar{X}_m\)</span> are <strong>normally distributed</strong> with:
<ul>
<li>Mean: <span class="math inline">\(\mu\)</span>.</li>
<li>Variance: <span class="math inline">\(\frac{\sigma^2}{n}\)</span>.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>We have; <span class="math display">\[
\frac{\bar{X}_{i.} - \mu}{\sqrt{\sigma^2/n}} = \frac{\sqrt{n}(\bar{X}_{i.} - \mu)}{\sigma}
\]</span> follows a standard normal distribution; hence, <span id="eq-anova3"><span class="math display">\[
  n \sum_{i=1}^{m} \frac{(\bar{X}_{i.} - \mu)^2}{\sigma^2} \sim \chi^2_m
   \tag{4.3}\]</span></span> follows a <strong>chi-square distribution</strong> with <strong>m degrees of freedom</strong> when <span class="math inline">\(H_0\)</span> is true.</p></li>
<li><p>When all population means are equal to <span class="math inline">\(\mu\)</span>, the <strong>estimator of <span class="math inline">\(\mu\)</span></strong> is the <strong>average of all nm data values</strong>, denoted as <span class="math inline">\(\bar{X}_{..}\)</span>: <span class="math display">\[
\bar{X}_{..} = \frac{\sum_{i=1}^{m} \sum_{j=1}^{n} X_{ij}}{nm} = \frac{\sum_{i=1}^{m} \bar{X}_{i.}}{m}
\]</span></p></li>
<li><p>Substituting <span class="math inline">\(\bar{X}_{..}\)</span> for the unknown parameter <span class="math inline">\(\mu\)</span> in <a href="#eq-anova3" class="quarto-xref">Equation&nbsp;<span>4.3</span></a>:</p>
<ul>
<li>When <span class="math inline">\(H_0\)</span> is true, the resulting quantity: <span class="math display">\[
n \sum_{i=1}^{m} \frac{(\bar{X}_{i.} - \bar{X}_{..})^2}{\sigma^2}
\]</span></li>
</ul></li>
<li><p>The resulting quantity: <span class="math display">\[
n \sum_{i=1}^{m} \frac{(\bar{X}_{i.} - \bar{X}_{..})^2}{\sigma^2}
\]</span> will be a <strong>chi-square random variable</strong> with <strong>m - 1 degrees of freedom</strong>.</p></li>
<li><p>Define <strong>SSb</strong> as: <span id="eq-ssb"><span class="math display">\[
SSb = n \sum_{i=1}^{m} (\bar{X}_{i.} - \bar{X}_{..})^2
\tag{4.4}\]</span></span></p>
<ul>
<li>It follows that, <strong>when <span class="math inline">\(H_0\)</span> is true</strong>: <span class="math display">\[
SSb / \sigma^2 \sim \chi^2_{m-1}
\]</span></li>
</ul></li>
<li><p>From the above, we derive that <strong>when <span class="math inline">\(H_0\)</span> is true</strong>: <span class="math display">\[
E[SSb] / \sigma^2 = m - 1
\]</span></p>
<ul>
<li>Equivalently: <span id="eq-anova4"><span class="math display">\[
E[SSb / (m - 1)] = \sigma^2
\tag{4.5}\]</span></span></li>
</ul></li>
<li><p>Therefore, <strong>when <span class="math inline">\(H_0\)</span> is true</strong>, <span class="math inline">\(SSb / (m - 1)\)</span> is also an <strong>estimator of <span class="math inline">\(\sigma^2\)</span></strong>.</p></li>
<li><p>The quantity SSb <a href="#eq-ssb" class="quarto-xref">Equation&nbsp;<span>4.4</span></a> is called the <strong>sum of squares between samples</strong> or between samples sum of squares or sum of squares between groups.</p></li>
<li><p>Note that <span class="math inline">\(E[SSb / (m - 1)]\)</span> is an estimate of <span class="math inline">\(\sigma^2\)</span> only if the hypothesis is true.</p></li>
<li><p>Thus we have shown that;</p>
<ul>
<li><span class="math inline">\(\frac{SSW}{nm-m}\)</span> always estimates <span class="math inline">\(\sigma^2\)</span>.</li>
<li><span class="math inline">\(\frac{SSb}{m-1}\)</span> estimates <span class="math inline">\(\sigma^2\)</span> when <span class="math inline">\(H_0\)</span> is true.</li>
</ul></li>
<li><p>Because it can be shown that <span class="math inline">\(\frac{SSb}{m-1}\)</span> will tend to exceed <span class="math inline">\(\sigma^2\)</span> when <span class="math inline">\(H_0\)</span> is not true, now it is reasonable to let the test statistic be given by</p></li>
</ul>
<p><span class="math display">\[
TS= \frac{\frac{SSb}{m-1} } {\frac{SSW}{nm-m}}
\]</span></p>
<p>and to reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(TS\)</span> is <strong>sufficiently large</strong>.</p>
<section id="how-to-do-the-hypothesis-testing" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="how-to-do-the-hypothesis-testing">How to do the hypothesis testing</h3>
<ul>
<li><p>To determine how large <span class="math inline">\(TS\)</span> needs to be to justify rejecting <span class="math inline">\(H_0\)</span>, we use the fact that:</p>
<ul>
<li><p>If <span class="math inline">\(H_0\)</span> is true, then <span class="math inline">\(SSb\)</span> and <span class="math inline">\(SSW\)</span> are independent.</p></li>
<li><p>It follows that, when <span class="math inline">\(H_0\)</span> is true, <span class="math inline">\(TS\)</span> has an <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(m-1\)</span> numerator and <span class="math inline">\(nm-m\)</span> denominator degrees of freedom.</p></li>
<li><p>Let <span class="math inline">\(F_{m-1,nm-m,\alpha}\)</span> denote the <span class="math inline">\(100(1-\alpha)\)</span> percentile of this distribution — that is, <span class="math inline">\(P\{F_{m-1,nm-m} &gt; F_{m-1,nm-m,\alpha}\} = \alpha\)</span>.</p></li>
<li><p>We use the notation <span class="math inline">\(F_{r,s}\)</span> to represent an <span class="math inline">\(F\)</span>-random variable with <span class="math inline">\(r\)</span> numerator and <span class="math inline">\(s\)</span> denominator degrees of freedom.</p></li>
</ul></li>
<li><p>The significance level <span class="math inline">\(\alpha\)</span> test of <span class="math inline">\(H_0\)</span> is as follows:</p>
<ul>
<li><p>Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\frac{\frac{SSb}{m-1} }{ \frac{SSW}{nm-m}} &gt; F_{m-1,nm-m,\alpha}\)</span>.</p></li>
<li><p>Do not reject <span class="math inline">\(H_0\)</span>, otherwise.</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The following <strong>algebraic identity</strong>, known as the <strong>sum of squares identity</strong>, is useful for simplifying computations, especially when done by hand:</p>
<p><strong>The Sum of Squares Identity</strong>: <span class="math display">\[
\sum_{i=1}^{m} \sum_{j=1}^{n} X_{ij}^2 = nm \bar{X}_{..}^2 + SSb + SSW
\]</span></p>
<ul>
<li>Here:
<ul>
<li><span class="math inline">\(\sum_{i=1}^{m} \sum_{j=1}^{n} X_{ij}^2\)</span> represents the <strong>total sum of squares</strong> of all observations.</li>
<li><span class="math inline">\(nm \bar{X}_{..}^2\)</span> is the contribution from the <strong>grand mean</strong> (<span class="math inline">\(\bar{X}_{..}\)</span>).</li>
<li><span class="math inline">\(SSb\)</span> (Sum of Squares Between) measures the variation <strong>between sample means</strong>.</li>
<li><span class="math inline">\(SSW\)</span> (Sum of Squares Within) measures the variation <strong>within each sample</strong>.</li>
</ul></li>
</ul></li>
<li><p>This identity helps decompose the total variability in the data into components that can be analyzed separately.</p></li>
<li><p>When performing calculations <strong>by hand</strong>, the quantity <strong>SSb</strong> (Sum of Squares Between) should be computed first. It is defined as: <span class="math display">\[
SSb = n \sum_{i=1}^{m} (\bar{X}_{i.} - \bar{X}_{..})^2
\]</span></p></li>
<li><p>Once <strong>SSb</strong> has been calculated, <strong>SSW</strong> (Sum of Squares Within) can be determined using the <strong>sum of squares identity</strong>. To do this:</p>
<ol type="1">
<li>Compute the total sum of squares: <span class="math display">\[
\sum_{i=1}^{m} \sum_{j=1}^{n} X_{ij}^2
\]</span></li>
<li>Compute the term involving the grand mean: <span class="math display">\[
nm \bar{X}_{..}^2
\]</span></li>
<li>Use the sum of squares identity to find <strong>SSW</strong>: <span class="math display">\[
SSW = \sum_{i=1}^{m} \sum_{j=1}^{n} X_{ij}^2 - nm \bar{X}_{..}^2 - SSb
\]</span></li>
</ol></li>
<li><p>This approach simplifies the computation process by breaking it into manageable steps and leveraging the sum of squares identity.</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternative Method
</div>
</div>
<div class="callout-body-container callout-body">
<p>Another useful identity involving the sum of squares is:</p>
<p><strong>Error Sum of Squares (<span class="math inline">\(SS_{total}\)</span>)</strong>: <span class="math inline">\(SS_{total}=SSb + SSW\)</span></p>
<p>where <strong>Total Sum of Squares (<span class="math inline">\(SS_{total}\)</span>)</strong>: <span class="math inline">\(SS_{total}=\sum_{i=1}^m\sum_{j=1}^n(X_{ij}-\bar{X}_{..})^2\)</span></p>
<ul>
<li><p>This identity can also be used for the anova analysis while performing the computations by hand.</p></li>
<li><p>This approach too simplifies the computation process by breaking it into manageable steps and leveraging the sum of squares identity.</p></li>
</ul>
</div>
</div>
</section>
<section id="summary-of-one-way-analysis-of-variance" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="summary-of-one-way-analysis-of-variance">Summary of one-way analysis of variance</h3>
<p><span class="math display">\[
\begin{array}{|c|c|c|}
\hline
\textbf{Source of Variation} &amp; \textbf{Sum of Squares} &amp; \textbf{Degrees of Freedom} \\
\hline
\text{Between samples} &amp; SS_b = n \sum_{i=1}^m (\bar{X}_{i.} - \bar{X}_{..})^2 &amp; m - 1 \\
\hline
\text{Within samples} &amp; SS_W = \sum_{i=1}^m \sum_{j=1}^n (X_{ij} - \bar{X}_{i.})^2 &amp; nm - m \\
\hline
\end{array}
\]</span></p>
<p>Value of Test Statistic, <span class="math inline">\(TS = \frac{SS_b/(m-1)}{SS_W/(nm-m)}\)</span></p>
<p>Significance level <span class="math inline">\(\alpha\)</span> test:<br>
reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(TS \geq F_{m-1,nm-m,\alpha}\)</span><br>
do not reject otherwise</p>
<p>If <span class="math inline">\(TS = v\)</span>, then <span class="math inline">\(p\)</span>-value = <span class="math inline">\(P\{F_{m-1,nm-m} \geq v\}\)</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>An auto rental firm is using 15 identical motors that are adjusted to run at a fixed speed to test 3 different brands of gasoline. Each brand of gasoline is assigned to exactly 5 of the motors. Each motor runs on 10 gallons of gasoline until it is out of fuel. The following data represents the <strong>total mileages</strong> achieved by different motors using three types of gas:</p>
<ul>
<li><strong>Gas 1</strong>: <span class="math inline">\(220, 251, 226, 246, 260\)</span></li>
<li><strong>Gas 2</strong>: <span class="math inline">\(244, 235, 232, 242, 225\)</span></li>
<li><strong>Gas 3</strong>: <span class="math inline">\(252, 272, 250, 238, 256\)</span></li>
</ul>
<p>Test the hypothesis that the <strong>average mileage</strong> is not affected by the type of gas used. <em>(In other words, determine if there is a significant difference in the mean mileages for the three types of gas.)</em></p>
</div>
</div>
</section>
<section id="multiple-comparisons-of-sample-means" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="multiple-comparisons-of-sample-means">Multiple Comparisons of Sample Means</h3>
<ul>
<li><p>When the null hypothesis of equal means is rejected, we are often interested in comparing the different sample means <span class="math inline">\(\mu_1, \dots, \mu_m\)</span>.</p></li>
<li><p>One commonly used procedure for this purpose is known as the <strong>T-method</strong>.</p></li>
<li><p>For a specified significance level <span class="math inline">\(\alpha\)</span>, this method provides <strong>joint confidence intervals</strong> for all <span class="math inline">\(\binom{m}{2}\)</span> differences <span class="math inline">\(\mu_i - \mu_j\)</span> (where <span class="math inline">\(i \neq j\)</span>, and <span class="math inline">\(i, j = 1, \dots, m\)</span>), ensuring that with probability <span class="math inline">\(1 - \alpha\)</span>, all confidence intervals will contain their respective differences <span class="math inline">\(\mu_i - \mu_j\)</span>.</p></li>
<li><p>The <strong>T-method</strong> is based on the following result:</p></li>
<li><p>With probability <span class="math inline">\(1 - \alpha\)</span>, for every <span class="math inline">\(i \neq j\)</span>: <span class="math display">\[
X_{i.} - X_{j.} - W &lt; \mu_i - \mu_j &lt; X_{i.} - X_{j.} + W
\]</span></p></li>
</ul>
<p>Where: - <span class="math inline">\(X_{i.}\)</span> and <span class="math inline">\(X_{j.}\)</span> are the sample means for groups <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, respectively. - <span class="math inline">\(W\)</span> is the critical value derived from the Studentized range distribution, adjusted for multiple comparisons.</p>
<p>where <span class="math display">\[
W = \sqrt{\frac{1}{n}} \cdot C(m, nm - m, \alpha) \cdot \sqrt{\frac{SSW}{(nm - m)}}
\]</span> and the values of <span class="math inline">\(C(m, nm - m, \alpha)\)</span> are provided for <span class="math inline">\(\alpha = 0.05\)</span> and <span class="math inline">\(\alpha = 0.01\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>A college administrator claims that there is no difference in first-year grade point averages for students entering the college from any of three different city high schools. The following data provide the first-year grade point averages of 12 randomly chosen students, 4 from each of the three high schools. At the 5 percent level of significance, do these data disprove the administrator’s claim? If so, determine confidence intervals for the difference in means of students from the different high schools, such that we can be 95 percent confident that all of the interval statements are valid.</p>
<p><strong>School 1</strong>: 3.2, 3.4, 3.3, 3.5<br>
<strong>School 2</strong>: 3.4, 3.0, 3.7, 3.3<br>
<strong>School 3</strong>: 2.8, 2.6, 3.0, 2.7</p>
</div>
</div>
</section>
<section id="one-way-analysis-of-variance-with-unequal-sample-sizes" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="one-way-analysis-of-variance-with-unequal-sample-sizes"><span class="header-section-number">4.2.1</span> One-Way Analysis of Variance with Unequal Sample Sizes</h3>
<p><span class="math display">\[
\begin{array}{|c|c|c|}
\hline
\textbf{Source of Variation} &amp; \textbf{Sum of Squares} &amp; \textbf{Degrees of Freedom} \\
\hline
\text{Between samples} &amp; SS_b =  \sum_{i=1}^m n_i (\bar{X}_{i.} - \bar{X}_{..})^2 &amp; m - 1 \\
\hline
\text{Within samples} &amp; SS_W = \sum_{i=1}^m \sum_{j=1}^n (X_{ij} - \bar{X}_{i.})^2 &amp; N - m \\
\hline
\end{array}
\]</span></p>
<p>where, N = <span class="math inline">\(\sum_{i=1}^m n_i\)</span></p>
<p>Value of Test Statistic, <span class="math inline">\(TS = \frac{SS_b/(m-1)}{SS_W/(N-m)}\)</span></p>
<p>Significance level <span class="math inline">\(\alpha\)</span> test:<br>
reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(TS \geq F_{m-1,N-m,\alpha}\)</span><br>
do not reject otherwise</p>
<p>If <span class="math inline">\(TS = v\)</span>, then <span class="math inline">\(p\)</span>-value = <span class="math inline">\(P\{F_{m-1,N-m} \geq v\}\)</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>Test the hypothesis that the following three independent samples are drawn from the same normal probability distribution.</p>
<p><strong>Sample 1:</strong> <span class="math inline">\(35, 37, 29, 27, 30\)</span><br>
<strong>Sample 2:</strong> <span class="math inline">\(29, 38, 34, 30, 32\)</span><br>
<strong>Sample 3:</strong> <span class="math inline">\(44, 52, 56\)</span></p>
<p>Use a statistical test to determine whether the means of these samples are significantly different.</p>
</div>
</div>
</section>
</section>
<section id="two-way-analysis-of-variance" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="two-way-analysis-of-variance"><span class="header-section-number">4.3</span> Two-way Analysis of Variance</h2>
<section id="introduction-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="introduction-1">Introduction</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider that four different examinations were administered to each of 5 students, with the scores shown in the table below. Each of the 20 data points is influenced by two factors: the <strong>exam</strong> and the <strong>student</strong> whose score on that exam is being recorded.</p>
<ul>
<li><p>The <strong>exam factor</strong> has 4 possible levels.</p></li>
<li><p>The <strong>student factor</strong> has 5 possible levels.</p></li>
<li><p><strong>Data Table</strong>: <span class="math display">\[
\begin{array}{c|ccccc}
\text{Exam} &amp; \text{Student 1} &amp; \text{Student 2} &amp; \text{Student 3} &amp; \text{Student 4} &amp; \text{Student 5} \\
\hline
1 &amp; 75 &amp; 73 &amp; 60 &amp; 70 &amp; 86 \\
2 &amp; 78 &amp; 71 &amp; 64 &amp; 72 &amp; 90 \\
3 &amp; 80 &amp; 69 &amp; 62 &amp; 70 &amp; 85 \\
4 &amp; 73 &amp; 67 &amp; 63 &amp; 80 &amp; 92 \\
\end{array}
\]</span></p></li>
</ul>
</div>
</div>
<ul>
<li><p>In general, suppose there are <strong>m possible levels</strong> of the first factor (row factor) and <strong>n possible levels</strong> of the second factor (column factor). Let <span class="math inline">\(X_{ij}\)</span> denote the value obtained when:</p>
<ul>
<li>The first factor is at level <span class="math inline">\(i\)</span>.</li>
<li>The second factor is at level <span class="math inline">\(j\)</span>.</li>
</ul></li>
<li><p>The data can be represented in an array format: <span class="math display">\[
\begin{array}{cccccc}
X_{11} &amp; X_{12} &amp; \dots &amp; X_{1j} &amp; \dots &amp; X_{1n} \\
X_{21} &amp; X_{22} &amp; \dots &amp; X_{2j} &amp; \dots &amp; X_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\
X_{i1} &amp; X_{i2} &amp; \dots &amp; X_{ij} &amp; \dots &amp; X_{in} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \ddots &amp; \vdots \\
X_{m1} &amp; X_{m2} &amp; \dots &amp; X_{mj} &amp; \dots &amp; X_{mn} \\
\end{array}
\]</span></p></li>
<li><p>Here, the <strong>first factor</strong> is referred to as the <strong>row factor</strong>, and the <strong>second factor</strong> is referred to as the <strong>column factor</strong>.</p></li>
<li><p>As in the case of one-way analysis assume that the data <span class="math inline">\(X_{ij}\)</span> (<span class="math inline">\(i = 1, \dots, m\)</span>, <span class="math inline">\(j = 1, \dots, n\)</span>) are <strong>independent normal random variables</strong> with a common variance <span class="math inline">\(\sigma^2\)</span>. However, unlike the one-way analysis, where only a single factor affected the mean value of a data point, we now assume that the mean value of the data depends <strong>additively</strong> on both its row and column factors.</p></li>
</ul>
</section>
<section id="summary-of-two-way-analysis-of-variance" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="summary-of-two-way-analysis-of-variance">Summary of Two-way analysis of variance</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 51%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Sum of Squares</th>
<th>Degrees of Freedom</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Row</td>
<td><span class="math inline">\(SS_r = n\sum_{i=1}^m (\bar{X}_{i.} - \bar{X}_{..})^2\)</span></td>
</tr>
<tr class="even">
<td>Column</td>
<td><span class="math inline">\(SS_c = m\sum_{j=1}^n (\bar{X}_{.j} - \bar{X}_{..})^2\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(SS_e = \sum_{i=1}^m \sum_{j=1}^n (X_{ij} - \bar{X}_{i.} - \bar{X}_{.j} + \bar{X}_{..})^2\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Let <span class="math inline">\(N = (m - 1)(n - 1)\)</span></strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Null Hypothesis</th>
<th>Test Statistic</th>
<th>Significance Level <span class="math inline">\(\alpha\)</span> Test</th>
<th>p-value if TS = <span class="math inline">\(v\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Row factor has no effect</td>
<td><span class="math inline">\(\frac{SS_r/(m - 1)}{SS_e/N}\)</span></td>
<td>Reject if <span class="math inline">\(TS \geq F_{m-1,N,\alpha}\)</span></td>
<td><span class="math inline">\(P\{F_{m-1,N} \geq v\}\)</span></td>
</tr>
<tr class="even">
<td>Column factor has no effect</td>
<td><span class="math inline">\(\frac{SS_c/(n - 1)}{SS_e/N}\)</span></td>
<td>Reject if <span class="math inline">\(TS \geq F_{n-1,N,\alpha}\)</span></td>
<td><span class="math inline">\(P\{F_{n-1,N} \geq v\}\)</span></td>
</tr>
</tbody>
</table>
<p>where:</p>
<ul>
<li><p><strong>Row Mean (<span class="math inline">\(\bar{X}_i.\)</span>)</strong>: <span class="math display">\[
\bar{X}_{i.} = \frac{\sum_{j=1}^n X_{ij}}{n} = \text{Average of the values in row } i
\]</span></p></li>
<li><p><strong>Column Mean (<span class="math inline">\(\bar{X}_{.j}\)</span>)</strong>: <span class="math display">\[
\bar{X}_{.j} = \frac{\sum_{i=1}^m X_{ij}}{m} = \text{Average of the values in column } j
\]</span></p></li>
<li><p><strong>Grand Mean (<span class="math inline">\(\bar{X}_{..}\)</span>)</strong>: <span class="math display">\[
\bar{X}_{..} = \frac{\sum_{i=1}^m \sum_{j=1}^n X_{ij}}{nm} = \text{Average of all data values}
\]</span></p></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>A researcher aims to investigate the impact of <strong>two factors</strong> on <strong>crop yield</strong>:</p>
<ol type="1">
<li><strong>Factor A (Fertilizer Type)</strong>: Two levels - Type 1 (<span class="math inline">\(T1\)</span>) and Type 2 (<span class="math inline">\(T2\)</span>).</li>
<li><strong>Factor B (Irrigation Level)</strong>: Three levels - Low (<span class="math inline">\(L\)</span>), Medium (<span class="math inline">\(M\)</span>), and High (<span class="math inline">\(H\)</span>).</li>
</ol>
<p>The researcher measures the <strong>yield (in kg)</strong> for each combination of factors. Due to the high cost of the experiment, only <strong>one observation</strong> is recorded for each combination. The data is as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Fertilizer</th>
<th>Irrigation</th>
<th>Yield (kg)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Type 1 (<span class="math inline">\(T1\)</span>)</td>
<td>Low (<span class="math inline">\(L\)</span>)</td>
<td>55</td>
</tr>
<tr class="even">
<td>Type 1 (<span class="math inline">\(T1\)</span>)</td>
<td>Medium (<span class="math inline">\(M\)</span>)</td>
<td>60</td>
</tr>
<tr class="odd">
<td>Type 1 (<span class="math inline">\(T1\)</span>)</td>
<td>High (<span class="math inline">\(H\)</span>)</td>
<td>70</td>
</tr>
<tr class="even">
<td>Type 2 (<span class="math inline">\(T2\)</span>)</td>
<td>Low (<span class="math inline">\(L\)</span>)</td>
<td>55</td>
</tr>
<tr class="odd">
<td>Type 2 (<span class="math inline">\(T2\)</span>)</td>
<td>Medium (<span class="math inline">\(M\)</span>)</td>
<td>65</td>
</tr>
<tr class="even">
<td>Type 2 (<span class="math inline">\(T2\)</span>)</td>
<td>High (<span class="math inline">\(H\)</span>)</td>
<td>75</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here also we have an useful identity for the sum of squares</p>
<p><strong>Total Sum of Squares (<span class="math inline">\(SS_{total}\)</span>)</strong>: <span class="math inline">\(SS_{total}=SS_{error}+SS_r+SS_c\)</span></p>
<p>where <strong>Total Sum of Squares (<span class="math inline">\(SS_{total}\)</span>)</strong>: <span class="math inline">\(SS_{total}=\sum_{i=1}^m\sum_{j=1}^n(X_{ij}-\bar{X}_{..})^2\)</span></p>
</div>
</div>
</section>
<section id="supplementary-topics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="supplementary-topics">Supplementary Topics</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Degrees of Freedom (dof)</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The statement <strong>“One degree of freedom is lost for each estimated parameter”</strong> is a key concept in statistics, especially in hypothesis testing and parameter estimation. Here’s a detailed explanation:</li>
</ul>
<section id="what-are-degrees-of-freedom" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="what-are-degrees-of-freedom"><strong>What Are Degrees of Freedom?</strong></h4>
<ul>
<li>Degrees of freedom (df) represent the number of independent pieces of information available to estimate a parameter or test a hypothesis.</li>
<li>In simpler terms, it’s the number of values in a calculation that are free to vary after certain constraints (like estimating parameters) are applied.</li>
</ul>
</section>
<section id="why-are-degrees-of-freedom-lost" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="why-are-degrees-of-freedom-lost"><strong>Why Are Degrees of Freedom Lost?</strong></h4>
<ul>
<li>When you estimate parameters (e.g., population means, variances) from sample data, you use the data itself to calculate these estimates.</li>
<li>Each time you estimate a parameter, you impose a constraint on the data, reducing the number of independent pieces of information available.</li>
<li><strong>Example</strong>: If you estimate the sample mean (<span class="math inline">\(\bar{X}\)</span>) from a dataset, you use the data to calculate <span class="math inline">\(\bar{X}\)</span>. This means one piece of information (one degree of freedom) is “used up” in estimating <span class="math inline">\(\bar{X}\)</span>, and the remaining data points are no longer fully independent.</li>
</ul>
</section>
<section id="application-in-the-context-of-the-problem" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="application-in-the-context-of-the-problem"><strong>Application in the Context of the Problem</strong></h4>
<ul>
<li>In the given problem:
<ol type="1">
<li>You have <strong>m samples</strong>, each of size <strong>n</strong>, and you estimate the mean of each sample (<span class="math inline">\(\mu_i\)</span>) using the sample mean (<span class="math inline">\(\bar{X}_{i.}\)</span>).</li>
<li>Each time you estimate a mean (<span class="math inline">\(\mu_i\)</span>), you lose <strong>one degree of freedom</strong> because the data is used to calculate that estimate.</li>
<li>Since you estimate <strong>m means</strong> (<span class="math inline">\(\mu_1, \mu_2, \dots, \mu_m\)</span>), you lose <strong>m degrees of freedom</strong> in total.</li>
</ol></li>
</ul>
</section>
<section id="mathematical-explanation" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="mathematical-explanation"><strong>Mathematical Explanation</strong></h4>
<ul>
<li><p>Initially, the sum of squares: <span class="math display">\[
\sum_{i=1}^{m} \sum_{j=1}^{n} \frac{(X_{ij} - \mu_i)^2}{\sigma^2}
\]</span> follows a chi-square distribution with <strong>nm degrees of freedom</strong> (since there are <strong>nm independent observations</strong>).</p></li>
<li><p>However, when you replace the true means (<span class="math inline">\(\mu_i\)</span>) with their estimates (<span class="math inline">\(\bar{X}_{i.}\)</span>), you lose <strong>m degrees of freedom</strong> (one for each estimated mean). This is because the estimates are derived from the data, reducing the independence of the observations.</p></li>
<li><p>As a result, the modified sum of squares: <span class="math display">\[
\sum_{i=1}^{m} \sum_{j=1}^{n} \frac{(X_{ij} - \bar{X}_{i.})^2}{\sigma^2}
\]</span> follows a chi-square distribution with <strong>nm - m degrees of freedom</strong>.</p></li>
</ul>
</section>
<section id="why-does-this-matter" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="why-does-this-matter"><strong>Why Does This Matter?</strong></h4>
<ul>
<li>Degrees of freedom affect the shape and critical values of the chi-square distribution, which is used for hypothesis testing.</li>
<li>Losing degrees of freedom accounts for the fact that estimating parameters introduces uncertainty into the analysis.</li>
<li>This adjustment ensures that statistical tests (e.g., ANOVA) are accurate and reliable.</li>
</ul>
</section>
<section id="summary" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="summary"><strong>Summary</strong></h4>
<ul>
<li><strong>Degrees of freedom</strong> represent independent information in the data.</li>
<li><strong>Each estimated parameter</strong> (e.g., a mean) reduces the degrees of freedom by 1 because the data is used to calculate the estimate.</li>
<li>In the problem, estimating <strong>m means</strong> reduces the degrees of freedom from <strong>nm</strong> to <strong>nm - m</strong>, ensuring the chi-square distribution is correctly applied.</li>
</ul>
</section>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./HypothesisTesting.html" class="pagination-link" aria-label="Hypothesis Testing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Regression.html" class="pagination-link" aria-label="Regression">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>